{"version":3,"file":"breadcrumbs.js","sourceRoot":"","sources":["../../src/integrations/breadcrumbs.ts"],"names":[],"mappings":"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","sourcesContent":["import { API, getCurrentHub } from '@sentry/core';\nimport { Breadcrumb, BreadcrumbHint, Integration, Severity } from '@sentry/types';\nimport { isString } from '@sentry/utils/is';\nimport { logger } from '@sentry/utils/logger';\nimport { getEventDescription, getGlobalObject, parseUrl } from '@sentry/utils/misc';\nimport { fill, normalize } from '@sentry/utils/object';\nimport { safeJoin } from '@sentry/utils/string';\nimport { supportsHistory, supportsNativeFetch } from '@sentry/utils/supports';\n\nimport { BrowserClient } from '../client';\n\nimport { breadcrumbEventHandler, keypressEventHandler, wrap } from './helpers';\n\nconst global = getGlobalObject<Window>();\nlet lastHref: string | undefined;\n\n/**\n * @hidden\n */\nexport interface SentryWrappedXMLHttpRequest extends XMLHttpRequest {\n  [key: string]: any;\n  __sentry_xhr__?: {\n    method?: string;\n    url?: string;\n    status_code?: number;\n  };\n}\n\n/** JSDoc */\ninterface BreadcrumbIntegrations {\n  console?: boolean;\n  dom?: boolean;\n  fetch?: boolean;\n  history?: boolean;\n  sentry?: boolean;\n  xhr?: boolean;\n}\n\n/** Default Breadcrumbs instrumentations */\nexport class Breadcrumbs implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public name: string = Breadcrumbs.id;\n\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'Breadcrumbs';\n\n  /** JSDoc */\n  private readonly _options: BreadcrumbIntegrations;\n\n  /**\n   * @inheritDoc\n   */\n  public constructor(options?: BreadcrumbIntegrations) {\n    this._options = {\n      console: true,\n      dom: true,\n      fetch: true,\n      history: true,\n      sentry: true,\n      xhr: true,\n      ...options,\n    };\n  }\n\n  /** JSDoc */\n  private _instrumentConsole(): void {\n    if (!('console' in global)) {\n      return;\n    }\n    ['debug', 'info', 'warn', 'error', 'log'].forEach(function(level: string): void {\n      if (!(level in global.console)) {\n        return;\n      }\n\n      fill(global.console, level, function(originalConsoleLevel: () => any): any {\n        return function(...args: any[]): any {\n          const breadcrumbData = {\n            category: 'console',\n            data: {\n              extra: {\n                arguments: normalize(args, 3),\n              },\n              logger: 'console',\n            },\n            level: Severity.fromString(level),\n            message: safeJoin(args, ' '),\n          };\n\n          if (level === 'assert') {\n            if (args[0] === false) {\n              breadcrumbData.message = `Assertion failed: ${safeJoin(args.slice(1), ' ') || 'console.assert'}`;\n              breadcrumbData.data.extra.arguments = normalize(args.slice(1), 3);\n            }\n          }\n\n          Breadcrumbs.addBreadcrumb(breadcrumbData, {\n            input: args,\n            level,\n          });\n\n          // this fails for some browsers. :(\n          if (originalConsoleLevel) {\n            Function.prototype.apply.call(originalConsoleLevel, global.console, args);\n          }\n        };\n      });\n    });\n  }\n\n  /** JSDoc */\n  private _instrumentDOM(): void {\n    if (!('document' in global)) {\n      return;\n    }\n    // Capture breadcrumbs from any click that is unhandled / bubbled up all the way\n    // to the document. Do this before we instrument addEventListener.\n    global.document.addEventListener('click', breadcrumbEventHandler('click'), false);\n    global.document.addEventListener('keypress', keypressEventHandler(), false);\n  }\n\n  /** JSDoc */\n  private _instrumentFetch(): void {\n    if (!supportsNativeFetch()) {\n      return;\n    }\n\n    fill(global, 'fetch', function(originalFetch: () => void): () => void {\n      return function(...args: any[]): void {\n        const fetchInput = args[0];\n        let method = 'GET';\n        let url;\n\n        if (typeof fetchInput === 'string') {\n          url = fetchInput;\n        } else if ('Request' in global && fetchInput instanceof Request) {\n          url = fetchInput.url;\n          if (fetchInput.method) {\n            method = fetchInput.method;\n          }\n        } else {\n          url = String(fetchInput);\n        }\n\n        if (args[1] && args[1].method) {\n          method = args[1].method;\n        }\n\n        const client = getCurrentHub().getClient<BrowserClient>();\n        const dsn = client && client.getDsn();\n        if (dsn) {\n          const filterUrl = new API(dsn).getStoreEndpoint();\n          // if Sentry key appears in URL, don't capture it as a request\n          // but rather as our own 'sentry' type breadcrumb\n          if (filterUrl && url.includes(filterUrl)) {\n            if (method === 'POST' && args[1] && args[1].body) {\n              addSentryBreadcrumb(args[1].body);\n            }\n            return originalFetch.apply(global, args);\n          }\n        }\n\n        const fetchData: {\n          method: string;\n          url: string;\n          status_code?: number;\n        } = {\n          method,\n          url,\n        };\n\n        return originalFetch\n          .apply(global, args)\n          .then((response: Response) => {\n            fetchData.status_code = response.status;\n            Breadcrumbs.addBreadcrumb(\n              {\n                category: 'fetch',\n                data: fetchData,\n                type: 'http',\n              },\n              {\n                input: args,\n                response,\n              },\n            );\n            return response;\n          })\n          .catch((error: Error) => {\n            Breadcrumbs.addBreadcrumb(\n              {\n                category: 'fetch',\n                data: fetchData,\n                level: Severity.Error,\n                type: 'http',\n              },\n              {\n                error,\n                input: args,\n              },\n            );\n\n            throw error;\n          });\n      };\n    });\n  }\n\n  /** JSDoc */\n  private _instrumentHistory(): void {\n    if (!supportsHistory()) {\n      return;\n    }\n\n    const captureUrlChange = (from: string | undefined, to: string | undefined): void => {\n      const parsedLoc = parseUrl(global.location.href);\n      const parsedTo = parseUrl(to as string);\n      let parsedFrom = parseUrl(from as string);\n\n      // Initial pushState doesn't provide `from` information\n      if (!parsedFrom.path) {\n        parsedFrom = parsedLoc;\n      }\n\n      // because onpopstate only tells you the \"new\" (to) value of location.href, and\n      // not the previous (from) value, we need to track the value of the current URL\n      // state ourselves\n      lastHref = to;\n\n      // Use only the path component of the URL if the URL matches the current\n      // document (almost all the time when using pushState)\n      if (parsedLoc.protocol === parsedTo.protocol && parsedLoc.host === parsedTo.host) {\n        // tslint:disable-next-line:no-parameter-reassignment\n        to = parsedTo.relative;\n      }\n      if (parsedLoc.protocol === parsedFrom.protocol && parsedLoc.host === parsedFrom.host) {\n        // tslint:disable-next-line:no-parameter-reassignment\n        from = parsedFrom.relative;\n      }\n\n      Breadcrumbs.addBreadcrumb({\n        category: 'navigation',\n        data: {\n          from,\n          to,\n        },\n      });\n    };\n\n    // record navigation (URL) changes\n    const oldOnPopState = global.onpopstate;\n    global.onpopstate = (...args: any[]) => {\n      const currentHref = global.location.href;\n      captureUrlChange(lastHref, currentHref);\n      if (oldOnPopState) {\n        return oldOnPopState.apply(this, args);\n      }\n    };\n\n    /**\n     * @hidden\n     */\n    function historyReplacementFunction(originalHistoryFunction: () => void): () => void {\n      // note history.pushState.length is 0; intentionally not declaring\n      // params to preserve 0 arity\n      return function(this: History, ...args: any[]): void {\n        const url = args.length > 2 ? args[2] : undefined;\n        // url argument is optional\n        if (url) {\n          // coerce to string (this is what pushState does)\n          captureUrlChange(lastHref, String(url));\n        }\n        return originalHistoryFunction.apply(this, args);\n      };\n    }\n\n    fill(global.history, 'pushState', historyReplacementFunction);\n    fill(global.history, 'replaceState', historyReplacementFunction);\n  }\n\n  /** JSDoc */\n  private _instrumentXHR(): void {\n    if (!('XMLHttpRequest' in global)) {\n      return;\n    }\n\n    /**\n     * @hidden\n     */\n    function wrapProp(prop: string, xhr: XMLHttpRequest): void {\n      // TODO: Fix XHR types\n      if (prop in xhr && typeof (xhr as { [key: string]: any })[prop] === 'function') {\n        fill(xhr, prop, original =>\n          wrap(original, {\n            mechanism: {\n              data: {\n                function: prop,\n                handler: (original && original.name) || '<anonymous>',\n              },\n              handled: true,\n              type: 'instrument',\n            },\n          }),\n        );\n      }\n    }\n\n    const xhrproto = XMLHttpRequest.prototype;\n    fill(\n      xhrproto,\n      'open',\n      originalOpen =>\n        function(this: SentryWrappedXMLHttpRequest, ...args: any[]): void {\n          const url = args[1];\n          this.__sentry_xhr__ = {\n            method: args[0],\n            url: args[1],\n          };\n\n          const client = getCurrentHub().getClient<BrowserClient>();\n          const dsn = client && client.getDsn();\n          if (dsn) {\n            const filterUrl = new API(dsn).getStoreEndpoint();\n            // if Sentry key appears in URL, don't capture it as a request\n            // but rather as our own 'sentry' type breadcrumb\n            if (isString(url) && (filterUrl && url.includes(filterUrl))) {\n              this.__sentry_own_request__ = true;\n            }\n          }\n\n          return originalOpen.apply(this, args);\n        },\n    );\n\n    fill(\n      xhrproto,\n      'send',\n      originalSend =>\n        function(this: SentryWrappedXMLHttpRequest, ...args: any[]): void {\n          const xhr = this; // tslint:disable-line:no-this-assignment\n\n          if (xhr.__sentry_own_request__) {\n            addSentryBreadcrumb(args[0]);\n          }\n\n          /**\n           * @hidden\n           */\n          function onreadystatechangeHandler(): void {\n            if (xhr.readyState === 4) {\n              if (xhr.__sentry_own_request__) {\n                return;\n              }\n              try {\n                // touching statusCode in some platforms throws\n                // an exception\n                if (xhr.__sentry_xhr__) {\n                  xhr.__sentry_xhr__.status_code = xhr.status;\n                }\n              } catch (e) {\n                /* do nothing */\n              }\n              Breadcrumbs.addBreadcrumb(\n                {\n                  category: 'xhr',\n                  data: xhr.__sentry_xhr__,\n                  type: 'http',\n                },\n                {\n                  xhr,\n                },\n              );\n            }\n          }\n\n          ['onload', 'onerror', 'onprogress'].forEach(prop => {\n            wrapProp(prop, xhr);\n          });\n\n          if ('onreadystatechange' in xhr && typeof xhr.onreadystatechange === 'function') {\n            fill(xhr, 'onreadystatechange', function(original: () => void): void {\n              return wrap(\n                original,\n                {\n                  mechanism: {\n                    data: {\n                      function: 'onreadystatechange',\n                      handler: (original && original.name) || '<anonymous>',\n                    },\n                    handled: true,\n                    type: 'instrument',\n                  },\n                },\n                onreadystatechangeHandler,\n              );\n            });\n          } else {\n            // if onreadystatechange wasn't actually set by the page on this xhr, we\n            // are free to set our own and capture the breadcrumb\n            xhr.onreadystatechange = onreadystatechangeHandler;\n          }\n          return originalSend.apply(this, args);\n        },\n    );\n  }\n\n  /**\n   * Helper that checks if integration is enabled on the client.\n   * @param breadcrumb Breadcrumb\n   * @param hint BreadcrumbHint\n   */\n  public static addBreadcrumb(breadcrumb: Breadcrumb, hint?: BreadcrumbHint): void {\n    if (getCurrentHub().getIntegration(Breadcrumbs)) {\n      getCurrentHub().addBreadcrumb(breadcrumb, hint);\n    }\n  }\n\n  /**\n   * Instrument browser built-ins w/ breadcrumb capturing\n   *  - Console API\n   *  - DOM API (click/typing)\n   *  - XMLHttpRequest API\n   *  - Fetch API\n   *  - History API\n   */\n  public setupOnce(): void {\n    if (this._options.console) {\n      this._instrumentConsole();\n    }\n    if (this._options.dom) {\n      this._instrumentDOM();\n    }\n    if (this._options.xhr) {\n      this._instrumentXHR();\n    }\n    if (this._options.fetch) {\n      this._instrumentFetch();\n    }\n    if (this._options.history) {\n      this._instrumentHistory();\n    }\n  }\n}\n\n/** JSDoc */\nfunction addSentryBreadcrumb(serializedData: string): void {\n  // There's always something that can go wrong with deserialization...\n  try {\n    const event: { [key: string]: any } = JSON.parse(serializedData);\n    Breadcrumbs.addBreadcrumb(\n      {\n        category: 'sentry',\n        event_id: event.event_id,\n        level: event.level || Severity.fromString('error'),\n        message: getEventDescription(event),\n      },\n      {\n        event,\n      },\n    );\n  } catch (_oO) {\n    logger.error('Error while adding sentry type breadcrumb');\n  }\n}\n"]}